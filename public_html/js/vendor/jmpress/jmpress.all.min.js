(function(e,t,n,r){"use strict";function s(e){if(!e){return}var t=1+e.substr(1).search(/[A-Z]/);var n=e.substr(0,t).toLowerCase();var r=e.substr(t).toLowerCase();return"-"+n+"-"+r}function o(e){if(!e){return""}return e+","}function u(e){if(e.length>0){return e}return null}function c(i){function S(t,n){var r=v(t);var i={oldStyle:e(t).attr("style")||""};var s={data:r,stepData:i};C.call(this,"beforeInitStep",e(t),s);i.delegate=r.delegate;C.call(this,"initStep",e(t),s);e(t).data("stepData",i);if(!e(t).attr("id")){e(t).attr("id","step-"+(n+1))}C.call(this,"applyStep",e(t),s)}function x(t){var n=e(t).data("stepData");e(t).attr("style",n.oldStyle);C.call(this,"unapplyStep",e(t),{stepData:n})}function T(t){C.call(this,"unapplyStep",e(t),{stepData:t.data("stepData")});C.call(this,"applyStep",e(t),{stepData:t.data("stepData")})}function N(){if(b){C.call(this,"setInactive",b,{stepData:e(b).data("stepData"),reason:"deinit"})}if(y.jmpressClass){e(c).removeClass(y.jmpressClass)}C.call(this,"beforeDeinit",e(this),{});e(l.stepSelector,c).each(function(e){x.call(c,this)});h.attr("style",m.container);if(l.fullscreen){e("html").attr("style","")}p.attr("style",m.area);e(g).children().each(function(){c.append(e(this))});if(l.fullscreen){g.remove()}else{g.remove();p.remove()}C.call(this,"afterDeinit",e(this),{});e(c).data("jmpressmethods",false);if(y.idleTimeout){clearTimeout(y.idleTimeout)}}function C(t,n,r){r.settings=l;r.current=y;r.container=h;r.parents=n?k(n):null;r.current=y;r.jmpress=this;var i={};e.each(l[t],function(e,t){i.value=t.call(c,n,r)||i.value});return i.value}function k(t){return e(t).parentsUntil(c).not(c).filter(l.stepSelector)}function L(e){return A({step:b,substep:w},e)}function A(t,n){var i;if(e.isPlainObject(t)){i=t.substep;t=t.step}if(typeof t==="string"){t=c.find(t).first()}if(!t||!e(t).data("stepData")){return false}O.call(this);var s=e(t).data("stepData");var o=false;C.call(this,"beforeChange",t,{stepData:s,reason:n,cancel:function(){o=true}});if(o){return r}var a={};var f=t;if(e(t).data("stepData").delegate){f=u(e(t).parentsUntil(c).filter(l.stepSelector).filter(s.delegate))||u(e(t).near(s.delegate))||u(e(t).near(s.delegate,true))||u(e(s.delegate,c));if(f){s=f.data("stepData")}else{f=t}}if(E){C.call(this,"setInactive",E,{stepData:e(E).data("stepData"),delegatedFrom:b,reason:n,target:a,nextStep:f,nextSubstep:i,nextStepData:s})}var h={stepData:s,delegatedFrom:t,reason:n,target:a,substep:i,prevStep:E,prevSubstep:w,prevStepData:E&&e(E).data("stepData")};C.call(this,"beforeActive",f,h);C.call(this,"setActive",f,h);if(y.jmpressClass){e(c).removeClass(y.jmpressClass)}e(c).addClass(y.jmpressClass="step-"+e(f).attr("id"));if(y.jmpressDelegatedClass){e(c).removeClass(y.jmpressDelegatedClass)}e(c).addClass(y.jmpressDelegatedClass="delegating-step-"+e(t).attr("id"));C.call(this,"applyTarget",f,e.extend({canvas:g,area:p,beforeActive:E},h));b=t;w=h.substep;E=f;if(y.idleTimeout){clearTimeout(y.idleTimeout)}y.idleTimeout=setTimeout(function(){C.call(this,"idle",f,h)},Math.max(1,l.transitionDuration-100));return f}function O(){(function t(){function i(){if(e(h).scrollTop()!==0||e(h).scrollLeft()!==0){t()}}if(e(h)[0].tagName==="BODY"){try{n.scrollTo(0,0)}catch(r){}}e(h).scrollTop(0);e(h).scrollLeft(0);setTimeout(i,1);setTimeout(i,10);setTimeout(i,100);setTimeout(i,200);setTimeout(i,400)})()}function M(e){return A.call(this,e,"jump")}function _(){return A.call(this,C.call(this,"selectNext",b,{stepData:e(b).data("stepData"),substep:w}),"next")}function D(){return A.call(this,C.call(this,"selectPrev",b,{stepData:e(b).data("stepData"),substep:w}),"prev")}function P(){return A.call(this,C.call(this,"selectHome",b,{stepData:e(b).data("stepData")}),"home")}function H(){return A.call(this,C.call(this,"selectEnd",b,{stepData:e(b).data("stepData")}),"end")}function B(t){d(g,t||{});return e(g)}function j(){return E&&e(E)}function F(t,n,r){if(!f[t]){e.error("callback "+t+" is not registered.")}else{return C.call(this,t,n,r)}}function I(){var e=navigator.userAgent.toLowerCase();return e.search(/(iphone)|(ipod)|(android)/)===-1||e.search(/(chrome)/)!==-1}i=e.extend(true,{},i||{});var s={};var o=null;for(o in f){s[o]=e.isFunction(i[o])?[i[o]]:i[o];i[o]=[]}var l=e.extend(true,{},a,i);for(o in f){if(s[o]){Array.prototype.push.apply(l[o],s[o])}}var c=e(this),h=null,p=null,m={container:"",area:""},g=null,y=null,b=false,w=null,E=false;c.data("jmpressmethods",{select:A,reselect:L,scrollFix:O,goTo:M,next:_,prev:D,home:P,end:H,canvas:B,container:function(){return h},settings:function(){return l},active:j,current:function(){return y},fire:F,init:function(t){S.call(this,e(t),y.nextIdNumber++)},deinit:function(t){if(t){x.call(this,e(t))}else{N.call(this)}},reapply:T});if(I()===false||C.call(this,"checkNoSupport",null,{})){if(l.notSupportedClass){c.addClass(l.notSupportedClass)}return}else{if(l.notSupportedClass){c.removeClass(l.notSupportedClass)}}var q=e(l.stepSelector,c);h=c;p=e("<div />");g=e("<div />");e(c).children().filter(q).each(function(){g.append(e(this))});if(l.fullscreen){h=e("body");e("html").css({overflow:"hidden"});p=c}m.area=p.attr("style")||"";m.container=h.attr("style")||"";if(l.fullscreen){h.css({height:"100%"});c.append(g)}else{h.css({position:"relative"});p.append(g);c.append(p)}e(h).addClass(l.containerClass);e(p).addClass(l.areaClass);e(g).addClass(l.canvasClass);t.documentElement.style.height="100%";h.css({overflow:"hidden"});var R={position:"absolute",transitionDuration:"0s"};R=e.extend({},l.animation,R);d(p,R);d(g,R);y={};C.call(this,"beforeInit",null,{canvas:g,area:p});q.each(function(e){S.call(c,this,e)});y.nextIdNumber=q.length;C.call(this,"afterInit",null,{});A.call(this,C.call(this,"selectInitialStep","init",{}));if(l.initClass){e(q).removeClass(l.initClass)}}function h(){return a}function p(t,n){if(e.isFunction(n)){if(g[t]){e.error("function "+t+" is already registered.")}else{g[t]=n}}else{if(f[t]){e.error("callback "+t+" is already registered.")}else{f[t]=1;a[t]=[]}}}function d(t,n){var r,s,o={};for(r in n){if(n.hasOwnProperty(r)){s=i(r);if(s!==null){o[s]=n[r]}}}e(t).css(o);return t}function v(t){function n(e){e=e.split("-");for(var t=1;t<e.length;t++){e[t]=e[t].substr(0,1).toUpperCase()+e[t].substr(1)}return e.join("")}if(e(t)[0].dataset){return e.extend({},e(t)[0].dataset)}var r={};var i=e(t)[0].attributes;e.each(i,function(e,t){if(t.nodeName.substr(0,5)==="data-"){r[n(t.nodeName.substr(5))]=t.nodeValue}});return r}function m(){return!!e(this).data("jmpressmethods")}var i=function(){var e=t.createElement("dummy").style,n="Webkit Moz O ms Khtml".split(" "),i={};return function(t){if(typeof i[t]==="undefined"){var s=t.charAt(0).toUpperCase()+t.substr(1),o=(t+" "+n.join(s+" ")+s).split(" ");i[t]=null;for(var u in o){if(e[o[u]]!==r){i[t]=o[u];break}}}return i[t]}}();var a={stepSelector:".step",containerClass:"",canvasClass:"",areaClass:"",notSupportedClass:"not-supported",fullscreen:true,animation:{transformOrigin:"top left",transitionProperty:o(s(i("transform")))+o(s(i("perspective")))+"opacity",transitionDuration:"1s",transitionDelay:"500ms",transitionTimingFunction:"ease-in-out",transformStyle:"preserve-3d"},transitionDuration:1500};var f={beforeChange:1,beforeInitStep:1,initStep:1,checkNoSupport:1,beforeInit:1,afterInit:1,beforeDeinit:1,afterDeinit:1,applyStep:1,unapplyStep:1,setInactive:1,beforeActive:1,setActive:1,selectInitialStep:1,selectPrev:1,selectNext:1,selectHome:1,selectEnd:1,idle:1,applyTarget:1};for(var l in f){a[l]=[]}var g={init:c,initialized:m,deinit:function(){},css:d,pfx:i,defaults:h,register:p,dataset:v};e.fn.jmpress=function(t){function n(){var n=e(this).data("jmpressmethods");if(n&&n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(g[t]){return g[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(f[t]&&n){var r=n.settings();var i=Array.prototype.slice.call(arguments,1)[0];if(e.isFunction(i)){r[t]=r[t]||[];r[t].push(i)}}else if(typeof t==="object"||!t){return c.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.jmpress")}return this}var r=arguments;var i;e(this).each(function(e,t){i=n.apply(t,r)});return i};e.extend({jmpress:function(t){if(g[t]){return g[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(f[t]){var n=Array.prototype.slice.call(arguments,1)[0];if(e.isFunction(n)){a[t].push(n)}else{e.error("Second parameter should be a function: $.jmpress( callbackName, callbackFunction )")}}else{e.error("Method "+t+" does not exist on jQuery.jmpress")}}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function i(t,n,r,i){var s;t.each(function(t,o){if(i){s=n(o,r,i);if(s){return false}}if(e(o).is(r)){s=o;return false}if(!i){s=n(o,r,i);if(s){return false}}});return s}function s(t,n,r){var o=e(t).children();if(r){o=e(o.get().reverse())}return i(o,s,n,r)}function o(t,n,r){return i(e(t)[r?"prevAll":"nextAll"](),s,n,r)}function u(t,n,r){var i;var s=e(t).parents();s=e(s.get());e.each(s.get(),function(t,s){if(r&&e(s).is(n)){i=s;return false}i=o(s,n,r);if(i){return false}});return i}e.fn.near=function(t,n){var r=[];e(this).each(function(e,i){var a=(n?false:s(i,t,n))||o(i,t,n)||u(i,t,n);if(a){r.push(a)}});return e(r)}})(jQuery,document,window);(function(e,t,n,r){"use strict";function i(e){return Math.round(1e4*e)/1e4+""}var s={3:{transform:function(t,n,r){var s="translate(-"+r.originX+",-"+r.originY+")";e.each(n,function(e,t){var n=["X","Y","Z"];var r;if(t[0]==="translate"){s+=" translate3d("+i(t[1]||0)+"px,"+i(t[2]||0)+"px,"+i(t[3]||0)+"px)"}else if(t[0]==="rotate"){var o=t[4]?[1,2,3]:[3,2,1];for(r=0;r<3;r++){s+=" rotate"+n[o[r]-1]+"("+i(t[o[r]]||0)+"deg)"}}else if(t[0]==="scale"){for(r=0;r<3;r++){s+=" scale"+n[r]+"("+i(t[r+1]||1)+")"}}});e.jmpress("css",t,e.extend({},{transform:s}))}},2:{transform:function(t,n,r){var s="translate(-"+r.originX+",-"+r.originY+")";e.each(n,function(e,t){var n=["X","Y"];if(t[0]==="translate"){s+=" translate("+i(t[1]||0)+"px,"+i(t[2]||0)+"px)"}else if(t[0]==="rotate"){s+=" rotate("+i(t[3]||0)+"deg)"}else if(t[0]==="scale"){for(var r=0;r<2;r++){s+=" scale"+n[r]+"("+i(t[r+1]||1)+")"}}});e.jmpress("css",t,e.extend({},{transform:s}))}}};var o=function(){if(e.jmpress("pfx","perspective")){return s[3]}else if(e.jmpress("pfx","transform")){return s[2]}}();if(!o){e.jmpress("checkNoSupport",function(){return true})}var u=e.jmpress("defaults");u.reasonableAnimation={};u.originX="50%";u.originY="50%";e.jmpress("initStep",function(t,n){var r=n.data;var i=n.stepData;var s=parseFloat;e.extend(i,{x:s(r.x)||0,y:s(r.y)||0,z:s(r.z)||0,r:s(r.r)||0,phi:s(r.phi)||0,rotate:s(r.rotate)||0,rotateX:s(r.rotateX)||0,rotateY:s(r.rotateY)||0,rotateZ:s(r.rotateZ)||0,revertRotate:false,scale:s(r.scale)||1,scaleX:s(r.scaleX)||false,scaleY:s(r.scaleY)||false,scaleZ:s(r.scaleZ)||1})});e.jmpress("beforeInit",function(t,n){e.jmpress("css",n.area,{left:n.settings.originX,top:n.settings.originY,perspective:"1000px"})});e.jmpress("afterInit",function(t,n){var r=n.settings.stepSelector,i=n.current;i.perspectiveScale=1;i.maxNestedDepth=0;var s=e(n.jmpress).find(r).children(r);while(s.length){i.maxNestedDepth++;s=s.children(r)}});e.jmpress("applyStep",function(t,n){e.jmpress("css",e(t),{position:"absolute",transformStyle:"preserve-3d"});if(n.parents.length>0){e.jmpress("css",e(t),{top:"50%",left:"50%"})}var r=n.stepData;var i=[["translate",r.x||r.r*Math.sin(r.phi*Math.PI/180),r.y||-r.r*Math.cos(r.phi*Math.PI/180),r.z],["rotate",r.rotateX,r.rotateY,r.rotateZ||r.rotate,true],["scale",r.scaleX||r.scale,r.scaleY||r.scale,r.scaleZ||r.scale]];o.transform(t,i,n.settings)});e.jmpress("setActive",function(t,n){var i=n.target;var s=n.stepData;var o=i.transform=[];i.perspectiveScale=1;for(var u=n.current.maxNestedDepth;u>(n.parents.length||0);u--){o.push(["scale"],["rotate"],["translate"])}o.push(["scale",1/(s.scaleX||s.scale),1/(s.scaleY||s.scale),1/s.scaleZ]);o.push(["rotate",-s.rotateX,-s.rotateY,-(s.rotateZ||s.rotate)]);o.push(["translate",-(s.x||s.r*Math.sin(s.phi*Math.PI/180)),-(s.y||-s.r*Math.cos(s.phi*Math.PI/180)),-s.z]);i.perspectiveScale*=s.scaleX||s.scale;e.each(n.parents,function(t,n){var r=e(n).data("stepData");o.push(["scale",1/(r.scaleX||r.scale),1/(r.scaleY||r.scale),1/r.scaleZ]);o.push(["rotate",-r.rotateX,-r.rotateY,-(r.rotateZ||r.rotate)]);o.push(["translate",-(r.x||r.r*Math.sin(r.phi*Math.PI/180)),-(r.y||-r.r*Math.cos(r.phi*Math.PI/180)),-r.z]);i.perspectiveScale*=r.scaleX||r.scale});e.each(o,function(e,t){function i(i){if(n.current["rotate"+i+"-"+e]===r){n.current["rotate"+i+"-"+e]=t[i]||0}var s=n.current["rotate"+i+"-"+e],o=t[i]||0,u=s%360,a=o%360;if(u<0){u+=360}if(a<0){a+=360}var f=a-u;if(f<-180){f+=360}else if(f>180){f-=360}n.current["rotate"+i+"-"+e]=t[i]=s+f}if(t[0]!=="rotate"){return}i(1);i(2);i(3)})});e.jmpress("applyTarget",function(t,n){var r=n.target,i,s=n.stepData,u=n.settings,a=r.perspectiveScale*1.3<n.current.perspectiveScale,f=r.perspectiveScale>n.current.perspectiveScale*1.3;var l=-1;e.each(r.transform,function(e,t){if(t.length<=1){return}if(t[0]==="rotate"&&t[1]%360===0&&t[2]%360===0&&t[3]%360===0){return}if(t[0]==="scale"){l=e}else{return false}});if(l!==n.current.oldLastScale){a=f=false;n.current.oldLastScale=l}var c=[];if(l!==-1){while(l>=0){if(r.transform[l][0]==="scale"){c.push(r.transform[l]);r.transform[l]=["scale"]}l--}}var h=u.animation;if(u.reasonableAnimation[n.reason]){h=e.extend({},h,u.reasonableAnimation[n.reason])}i={perspective:Math.round(r.perspectiveScale*1e3)+"px"};i=e.extend({},h,i);if(!a){i.transitionDelay="0s"}if(!n.beforeActive){i.transitionDuration="0s";i.transitionDelay="0s"}e.jmpress("css",n.area,i);o.transform(n.area,c,n.settings);i=e.extend({},h);if(!f){i.transitionDelay="0s"}if(!n.beforeActive){i.transitionDuration="0s";i.transitionDelay="0s"}n.current.perspectiveScale=r.perspectiveScale;e.jmpress("css",n.canvas,i);o.transform(n.canvas,r.transform,n.settings)})})(jQuery,document,window);(function(e,t,n,r){"use strict";var i=e.jmpress;var s="activeClass",o="nestedActiveClass";var u=i("defaults");u[o]="nested-active";u[s]="active";i("setInactive",function(t,n){var r=n.settings,i=r[s],u=r[o];if(i){e(t).removeClass(i)}if(u){e.each(n.parents,function(t,n){e(n).removeClass(u)})}});i("setActive",function(t,n){var r=n.settings,i=r[s],u=r[o];if(i){e(t).addClass(i)}if(u){e.each(n.parents,function(t,n){e(n).addClass(u)})}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function s(t,n){return e(this).find(n.settings.stepSelector).first()}function o(t,n,r,i){if(!n){return false}var s=r.settings.stepSelector;n=e(n);do{var o=n.near(s,i);if(o.length===0||o.closest(t).length===0){o=e(t).find(s)[i?"last":"first"]()}if(!o.length){return false}n=o}while(n.data("stepData").exclude);return n}var i=e.jmpress;i("initStep",function(e,t){t.stepData.exclude=t.data.exclude&&["false","no"].indexOf(t.data.exclude)===-1});i("selectInitialStep",s);i("selectHome",s);i("selectEnd",function(t,n){return e(this).find(n.settings.stepSelector).last()});i("selectPrev",function(e,t){return o(this,e,t,true)});i("selectNext",function(e,t){return o(this,e,t)})})(jQuery,document,window);(function(e,t,n,r){"use strict";e.jmpress("selectInitialStep",function(e,t){return t.settings.start})})(jQuery,document,window);(function(e,t,n,r){"use strict";function s(t,n,r){for(var i=0;i<n.length-1;i++){var s=n[i];var o=n[i+1];if(e(t).jmpress("initialized")){e(s,t).data("stepData")[r]=o}else{e(s,t).attr("data-"+r,o)}}}function o(t,n,r,i){var s=n.stepData;if(s[r]){var o=e(t).near(s[r],i);if(o&&o.length){return o}o=e(s[r],this)[i?"last":"first"]();if(o&&o.length){return o}}}var i=e.jmpress;i("register","route",function(e,t,n){if(typeof e==="string"){e=[e,e]}s(this,e,n?"prev":"next");if(!t){s(this,e.reverse(),n?"next":"prev")}});i("initStep",function(e,t){for(var n in{next:1,prev:1}){t.stepData[n]=t.data[n]}});i("selectNext",function(e,t){return o.call(this,e,t,"next")});i("selectPrev",function(e,t){return o.call(this,e,t,"prev",true)})})(jQuery,document,window);(function(e,t,n,r){"use strict";var i=e.jmpress;var s="ajax:afterStepLoaded",o="ajax:loadStep";i("register",o);i("register",s);i("defaults").ajaxLoadedClass="loaded";i("initStep",function(t,n){n.stepData.src=e(t).attr("href")||n.data.src||false;n.stepData.srcLoaded=false});i(o,function(t,n){var r=n.stepData,i=r&&r.src,o=n.settings;if(i){e(t).addClass(o.ajaxLoadedClass);r.srcLoaded=true;e(t).load(i,function(r,i,o){e(n.jmpress).jmpress("fire",s,t,e.extend({},n,{response:r,status:i,xhr:o}))})}});i("idle",function(t,n){if(!t){return}var r=n.settings,i=e(this),s=n.stepData;var u=e(t).add(e(t).near(r.stepSelector)).add(e(t).near(r.stepSelector,true)).add(i.jmpress("fire","selectPrev",t,{stepData:e(t).data("stepData")})).add(i.jmpress("fire","selectNext",t,{stepData:e(t).data("stepData")}));u.each(function(){var t=this,n=e(t).data("stepData");if(!n.src||n.srcLoaded){return}i.jmpress("fire",o,t,{stepData:e(t).data("stepData")})})});i("setActive",function(t,n){var r=e(t).data("stepData");if(!r.src||r.srcLoaded){return}e(this).jmpress("fire",o,t,{stepData:e(t).data("stepData")})})})(jQuery,document,window);(function(e,t,n,r){"use strict";function o(){return""+Math.round(Math.random()*1e5,0)}function u(t){try{var i=e("#"+n.location.hash.replace(/^#\/?/,""));return i.length>0&&i.is(t.stepSelector)?i:r}catch(s){}}function a(e){var t="#/"+e;if(n.history&&n.history.pushState){if(n.location.hash!==t){n.history.pushState({},"",t)}}else{if(n.location.hash!==t){n.location.hash=t}}}var i=e.jmpress,s="a[href^=#]";i("defaults").hash={use:true,update:true,bindChange:true};i("selectInitialStep",function(t,r){var i=r.settings,f=i.hash,l=r.current,c=e(this);r.current.hashNamespace=".jmpress-"+o();if(f.use){if(f.bindChange){e(n).bind("hashchange"+l.hashNamespace,function(e){var t=u(i);if(c.jmpress("initialized")){c.jmpress("scrollFix")}if(t&&t.length){if(t.attr("id")!==c.jmpress("active").attr("id")){c.jmpress("select",t)}a(t.attr("id"))}e.preventDefault()});e(s).on("click"+l.hashNamespace,function(t){var n=e(this).attr("href");try{if(e(n).is(i.stepSelector)){c.jmpress("select",n);t.preventDefault();t.stopPropagation()}}catch(r){}})}return u(i)}});i("afterDeinit",function(t,r){e(s).off(r.current.hashNamespace);e(n).unbind(r.current.hashNamespace)});i("setActive",function(t,n){var r=n.settings,i=n.current;if(r.hash.use&&r.hash.update){clearTimeout(i.hashtimeout);i.hashtimeout=setTimeout(function(){a(e(n.delegatedFrom).attr("id"))},r.transitionDuration+200)}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function u(){return""+Math.round(Math.random()*1e5,0)}function a(e){e.preventDefault();e.stopPropagation()}var i=e.jmpress,s="next",o="prev";i("defaults").keyboard={use:true,keys:{33:o,37:o,38:o,9:s+":"+o,32:s,34:s,39:s,40:s,36:"home",35:"end"},ignore:{INPUT:[32,37,38,39,40],TEXTAREA:[32,37,38,39,40],SELECT:[38,40]},tabSelector:"a[href]:visible, :input:visible"};i("afterInit",function(n,i){var s=i.settings,o=s.keyboard,f=o.ignore,l=i.current,c=e(this);if(!s.fullscreen){c.attr("tabindex",0)}l.keyboardNamespace=".jmpress-"+u();e(s.fullscreen?t:c).bind("keypress"+l.keyboardNamespace,function(e){for(var t in f){if(e.target.nodeName===t&&f[t].indexOf(e.which)!==-1){return}}if(e.which>=37&&e.which<=40||e.which===32){a(e)}});e(s.fullscreen?t:c).bind("keydown"+l.keyboardNamespace,function(t){var n=e(t.target);if(!s.fullscreen&&!n.closest(c).length||!o.use){return}for(var i in f){if(n[0].nodeName===i&&f[i].indexOf(t.which)!==-1){return}}var u=false;var l;if(t.which===9){if(!n.closest(c.jmpress("active")).length){if(!t.shiftKey){l=c.jmpress("active").find("a[href], :input").filter(":visible").first()}else{u=true}}else{l=n.near(o.tabSelector,t.shiftKey);if(!e(l).closest(s.stepSelector).is(c.jmpress("active"))){l=r}}if(l&&l.length>0){l.focus();c.jmpress("scrollFix");a(t);return}else{if(t.shiftKey){u=true}}}var h=o.keys[t.which];if(typeof h==="string"){if(h.indexOf(":")!==-1){h=h.split(":");h=t.shiftKey?h[1]:h[0]}c.jmpress(h);a(t)}else if(e.isFunction(h)){h.call(c,t)}else if(h){c.jmpress.apply(c,h);a(t)}if(u){l=c.jmpress("active").find("a[href], :input").filter(":visible").last();l.focus();c.jmpress("scrollFix")}})});i("afterDeinit",function(n,r){e(t).unbind(r.current.keyboardNamespace)})})(jQuery,document,window);(function(e,t,n,r){"use strict";function s(){return""+Math.round(Math.random()*1e5,0)}var i=e.jmpress;i("defaults").mouse={clickSelects:true};i("afterInit",function(t,n){var r=n.settings,i=r.stepSelector,o=n.current,u=e(this);o.clickableStepsNamespace=".jmpress-"+s();u.bind("click"+o.clickableStepsNamespace,function(t){if(!r.mouse.clickSelects||o.userZoom){return}var n=e(t.target).closest(i);if(n.is(u.jmpress("active"))){return}if(n.length){u.jmpress("select",n[0],"click");t.preventDefault();t.stopPropagation()}})});i("afterDeinit",function(t,n){e(this).unbind(n.current.clickableStepsNamespace)})})(jQuery,document,window);(function(e,t,n,r){"use strict";function s(){return""+Math.round(Math.random()*1e5,0)}var i=e.jmpress;i("afterInit",function(n,r){var i=r.settings,o=r.current,u=r.jmpress;o.mobileNamespace=".jmpress-"+s();var a,f=[0,0];e(i.fullscreen?t:u).bind("touchstart"+o.mobileNamespace,function(e){a=e.originalEvent.touches[0];f=[a.pageX,a.pageY]}).bind("touchmove"+o.mobileNamespace,function(e){a=e.originalEvent.touches[0];e.preventDefault();return false}).bind("touchend"+o.mobileNamespace,function(t){var n=[a.pageX,a.pageY],r=[n[0]-f[0],n[1]-f[1]];if(Math.max(Math.abs(r[0]),Math.abs(r[1]))>50){r=Math.abs(r[0])>Math.abs(r[1])?r[0]:r[1];e(u).jmpress(r>0?"prev":"next");t.preventDefault();return false}})});i("afterDeinit",function(n,r){var i=r.settings,s=r.current,o=r.jmpress;e(i.fullscreen?t:o).unbind(s.mobileNamespace)})})(jQuery,document,window);(function(e,t,n,r){"use strict";function a(t,n,i){for(var s in n){var o=s;if(i){o=i+o.substr(0,1).toUpperCase()+o.substr(1)}if(e.isPlainObject(n[s])){a(t,n[s],o)}else if(t[o]===r){t[o]=n[s]}}}function f(t,n){if(e.isArray(n)){if(n.length<t.length){e.error("more nested steps than children in template")}else{t.each(function(t,r){r=e(r);var i=r.data(s)||{};a(i,n[t]);r.data(s,i)})}}else if(e.isFunction(n)){t.each(function(r,i){i=e(i);var o=i.data(s)||{};a(o,n(r,i,t));i.data(s,o)})}}function l(e,t,n,r){if(n.children){var i=t.children(r.settings.stepSelector);f(i,n.children)}c(e,n)}function c(e,t){a(e,t)}var i=e.jmpress,s="_template_",o="_applied_template_";var u={};i("beforeInitStep",function(t,n){t=e(t);var r=n.data,i=r.template,a=t.data(o),f=t.data(s);if(i){e.each(i.split(" "),function(e,i){var s=u[i];l(r,t,s,n)})}if(a){l(r,t,a,n)}if(f){l(r,t,f,n);t.data(s,null);if(f.template){e.each(f.template.split(" "),function(e,i){var s=u[i];l(r,t,s,n)})}}});i("beforeInit",function(t,n){var r=i("dataset",this),s=r.template,o=n.settings.stepSelector;if(s){var a=u[s];f(e(this).find(o).filter(function(){return!e(this).parent().is(o)}),a.children)}});i("register","template",function(t,n){if(u[t]){u[t]=e.extend(true,{},u[t],n)}else{u[t]=e.extend(true,{},n)}});i("register","apply",function(t,n){if(!n){var r=e(this).jmpress("settings").stepSelector;f(e(this).find(r).filter(function(){return!e(this).parent().is(r)}),t)}else if(e.isArray(n)){f(e(t),n)}else{var i;if(typeof n==="string"){i=u[n]}else{i=e.extend(true,{},n)}e(t).each(function(t,n){n=e(n);var r=n.data(o)||{};a(r,i);n.data(o,r)})}})})(jQuery,document,window);(function(e,t,n,r){"use strict";e.jmpress("setActive",function(t,n){if(n.prevStep!==t){e(t).triggerHandler("enterStep")}});e.jmpress("setInactive",function(t,n){if(n.nextStep!==t){e(t).triggerHandler("leaveStep")}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function i(t){var n=t.split(" ");var r=n[0];var i={willClass:"will-"+r,doClass:"do-"+r,hasClass:"has-"+r};var s="";for(var o=1;o<n.length;o++){var u=n[o];switch(s){case"":if(u==="after"){s="after"}else{e.warn("unknown keyword in '"+t+"'. '"+u+"' unknown.")}break;case"after":if(u.match(/^[1-9][0-9]*m?s?/)){var a=parseFloat(u);if(u.indexOf("ms")!==-1){a*=1}else if(u.indexOf("s")!==-1){a*=1e3}else if(u.indexOf("m")!==-1){a*=6e4}i.delay=a}else{i.after=Array.prototype.slice.call(n,o).join(" ");o=n.length}}}return i}function s(t,n,r,i){i=i||t.length-1;r=r||0;for(var s=r;s<i+1;s++){if(e(t[s].element).is(n)){return s}}}function o(t,n,r){e.each(n._on,function(e,n){t.push({substep:n.substep,delay:n.delay+r});o(t,n.substep,n.delay+r)})}e.jmpress("defaults").customAnimationDataAttribute="jmpress";e.jmpress("afterInit",function(e,t){t.current.animationTimeouts=[];t.current.animationCleanupWaiting=[]});e.jmpress("applyStep",function(t,n){function h(e,t){if(t.substep._after){f=t.substep._after;return false}}var u={};var a=[];e(t).find("[data-"+n.settings.customAnimationDataAttribute+"]").each(function(r,i){if(e(i).closest(n.settings.stepSelector).is(t)){a.push({element:i})}});if(a.length===0){return}e.each(a,function(t,r){r.info=i(e(r.element).data(n.settings.customAnimationDataAttribute));e(r.element).addClass(r.info.willClass);r._on=[];r._after=null});var f={_after:r,_on:[],info:{}};e.each(a,function(e,t){var n=t.info.after;if(n){if(n==="step"){n=f}else if(n==="prev"){n=a[e-1]}else{var i=s(a,n,0,e-1);if(i===r){i=s(a,n)}n=i===r||i===e?a[e-1]:a[i]}}else{n=a[e-1]}if(n){if(!t.info.delay){if(!n._after){n._after=t;return}n=n._after}n._on.push({substep:t,delay:t.info.delay||0})}});if(f._after===r&&f._on.length===0){var l=s(a,n.stepData.startSubstep)||0;f._after=a[l]}var c=[];do{var p=[{substep:f,delay:0}];o(p,f,0);c.push(p);f=null;e.each(p,h)}while(f);u.list=c;e(t).data("substepsData",u)});e.jmpress("unapplyStep",function(t,n){var r=e(t).data("substepsData");if(r){e.each(r.list,function(t,n){e.each(n,function(t,n){if(n.substep.info.willClass){e(n.substep.element).removeClass(n.substep.info.willClass)}if(n.substep.info.hasClass){e(n.substep.element).removeClass(n.substep.info.hasClass)}if(n.substep.info.doClass){e(n.substep.element).removeClass(n.substep.info.doClass)}})})}});e.jmpress("setActive",function(t,n){var i=e(t).data("substepsData");if(!i){return}if(n.substep===r){n.substep=n.reason==="prev"?i.list.length-1:0}var s=n.substep;e.each(n.current.animationTimeouts,function(e,t){clearTimeout(t)});n.current.animationTimeouts=[];e.each(i.list,function(t,r){var i=t<s;var o=t<=s;e.each(r,function(t,r){function s(){e(r.substep.element).addClass(r.substep.info.doClass)}if(r.substep.info.hasClass){e(r.substep.element)[(i?"add":"remove")+"Class"](r.substep.info.hasClass)}if(o&&!i&&r.delay&&n.reason!=="prev"){if(r.substep.info.doClass){e(r.substep.element).removeClass(r.substep.info.doClass);n.current.animationTimeouts.push(setTimeout(s,r.delay))}}else{if(r.substep.info.doClass){e(r.substep.element)[(o?"add":"remove")+"Class"](r.substep.info.doClass)}}})})});e.jmpress("setInactive",function(t,n){function r(t){e.each(t.list,function(t,n){e.each(n,function(t,n){if(n.substep.info.hasClass){e(n.substep.element).removeClass(n.substep.info.hasClass)}if(n.substep.info.doClass){e(n.substep.element).removeClass(n.substep.info.doClass)}})})}if(n.nextStep===t){return}e.each(n.current.animationCleanupWaiting,function(e,t){r(t)});n.current.animationCleanupWaiting=[];var i=e(t).data("substepsData");if(i){n.current.animationCleanupWaiting.push(i)}});e.jmpress("selectNext",function(t,n){if(n.substep===r){return}var i=e(t).data("substepsData");if(!i){return}if(n.substep<i.list.length-1){return{step:t,substep:n.substep+1}}});e.jmpress("selectPrev",function(t,n){if(n.substep===r){return}var i=e(t).data("substepsData");if(!i){return}if(n.substep>0){return{step:t,substep:n.substep-1}}})})(jQuery,document,window);(function(e,t,n,r){"use strict";e.jmpress("register","toggle",function(n,r,i){var s=this;e(t).bind("keydown",function(t){if(t.keyCode===n){if(e(s).jmpress("initialized")){e(s).jmpress("deinit")}else{e(s).jmpress(r)}}});if(i){e(s).jmpress(r)}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function i(t,n,r){if(t.secondary&&t.secondary.split(" ").indexOf(n)!==-1){for(var i in t){if(i.length>9&&i.indexOf("secondary")===0){var s=t[i];var o=i.substr(9);o=o.substr(0,1).toLowerCase()+o.substr(1);t[i]=t[o];t[o]=s}}e(this).jmpress("reapply",e(r))}}e.jmpress("initStep",function(e,t){for(var n in t.data){if(n.indexOf("secondary")===0){t.stepData[n]=t.data[n]}}});e.jmpress("beforeActive",function(t,n){function s(t,r){var s=e(r).data("stepData");i.call(n.jmpress,s,"grandchildren",r)}i.call(n.jmpress,e(t).data("stepData"),"self",t);var r=e(t).parent();e(r).children(n.settings.stepSelector).each(function(t,r){var s=e(r).data("stepData");i.call(n.jmpress,s,"siblings",r)});for(var o=1;o<n.parents.length;o++){e(n.parents[o]).children(n.settings.stepSelector).each()}});e.jmpress("setInactive",function(t,n){function s(t,r){var s=e(r).data("stepData");i.call(n.jmpress,s,"grandchildren",r)}i.call(n.jmpress,e(t).data("stepData"),"self",t);var r=e(t).parent();e(r).children(n.settings.stepSelector).each(function(t,r){var s=e(r).data("stepData");i.call(n.jmpress,s,"siblings",r)});for(var o=1;o<n.parents.length;o++){e(n.parents[o]).children(n.settings.stepSelector).each(s)}})})(jQuery,document,window);(function(e,t,n,r){"use strict";e.jmpress("defaults").duration={defaultValue:-1,defaultAction:"next",barSelector:r,barProperty:"width",barPropertyStart:"0",barPropertyEnd:"100%"};e.jmpress("initStep",function(e,t){t.stepData.duration=t.data.duration&&parseInt(t.data.duration,10);t.stepData.durationAction=t.data.durationAction});e.jmpress("setInactive",function(t,n){var r=n.settings,i=r.duration,s=n.current;var o=n.stepData.duration||i.defaultValue;if(s.durationTimeout){if(i.barSelector){var u={transitionProperty:i.barProperty,transitionDuration:"0",transitionDelay:"0",transitionTimingFunction:"linear"};u[i.barProperty]=i.barPropertyStart;var a=e(i.barSelector);e.jmpress("css",a,u);a.each(function(t,n){var r=e(n).next();var i=e(n).parent();e(n).detach();if(r.length){r.insertBefore(n)}else{i.append(n)}})}clearTimeout(s.durationTimeout);delete s.durationTimeout}});e.jmpress("setActive",function(t,n){var i=n.settings,s=i.duration,o=n.current;var u=n.stepData.duration||s.defaultValue;if(u&&u>0){if(s.barSelector){var a={transitionProperty:s.barProperty,transitionDuration:u-i.transitionDuration*2/3-100+"ms",transitionDelay:i.transitionDuration*2/3+"ms",transitionTimingFunction:"linear"};a[s.barProperty]=s.barPropertyEnd;e.jmpress("css",e(s.barSelector),a)}var f=this;if(o.durationTimeout){clearTimeout(o.durationTimeout);o.durationTimeout=r}o.durationTimeout=setTimeout(function(){var t=n.stepData.durationAction||s.defaultAction;e(f).jmpress(t)},u)}})})(jQuery,document,window);(function(e,t,n,r){"use strict";function o(){return""+Math.round(Math.random()*1e5,0)}var i=e.jmpress;var s="jmpress-presentation-";i("defaults").presentationMode={use:true,url:"presentation-screen.html",notesUrl:false,transferredValues:["userZoom","userTranslateX","userTranslateY"]};i("defaults").keyboard.keys[80]="presentationPopup";i("afterInit",function(t,r){var i=r.current;i.selectMessageListeners=[];if(r.settings.presentationMode.use){n.addEventListener("message",function(t){try{if(typeof t.data!=="string"||t.data.indexOf(s)!==0){return}var o=JSON.parse(t.data.slice(s.length));switch(o.type){case"select":e.each(r.settings.presentationMode.transferredValues,function(e,t){r.current[t]=o[t]});if(/[a-z0-9\-]+/i.test(o.targetId)&&typeof o.substep in{number:1,"undefined":1}){e(r.jmpress).jmpress("select",{step:"#"+o.targetId,substep:o.substep},o.reason)}else{e.error("For security reasons the targetId must match /[a-z0-9\\-]+/i and substep must be a number.")}break;case"listen":i.selectMessageListeners.push(t.source);break;case"ok":clearTimeout(i.presentationPopupTimeout);break;case"read":try{t.source.postMessage(s+JSON.stringify({type:"url",url:n.location.href,notesUrl:r.settings.presentationMode.notesUrl}),"*")}catch(u){e.error("Cannot post message to source: "+u)}break;default:throw"Unknown message type: "+o.type}}catch(u){e.error("Received message is malformed: "+u)}});try{if(n.parent&&n.parent!==n){n.parent.postMessage(s+JSON.stringify({type:"afterInit"}),"*")}}catch(o){e.error("Cannot post message to parent: "+o)}}});i("afterDeinit",function(t,r){if(r.settings.presentationMode.use){try{if(n.parent&&n.parent!==n){n.parent.postMessage(s+JSON.stringify({type:"afterDeinit"}),"*")}}catch(i){e.error("Cannot post message to parent: "+i)}}});i("setActive",function(t,n){var r=e(n.delegatedFrom).attr("id"),i=n.substep,o=n.reason;e.each(n.current.selectMessageListeners,function(t,u){try{var a={type:"select",targetId:r,substep:i,reason:o};e.each(n.settings.presentationMode.transferredValues,function(e,t){a[t]=n.current[t]});u.postMessage(s+JSON.stringify(a),"*")}catch(f){e.error("Cannot post message to listener: "+f)}})});i("register","presentationPopup",function(){function t(){r.jmpress("current").presentationPopupTimeout=setTimeout(t,100);try{i.postMessage(s+JSON.stringify({type:"url",url:n.location.href,notesUrl:r.jmpress("settings").presentationMode.notesUrl}),"*")}catch(e){}}var r=e(this),i;if(r.jmpress("settings").presentationMode.use){i=n.open(e(this).jmpress("settings").presentationMode.url);r.jmpress("current").presentationPopupTimeout=setTimeout(t,100)}})})(jQuery,document,window);